<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Gene set analysis for hurdle model — gseaAfterBoot • MAST</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Gene set analysis for hurdle model — gseaAfterBoot"><meta property="og:description" content="Modules defined in sets are tested for average differences in expression from the &quot;average&quot; gene.
By using bootstraps, the between-gene covariance of terms in the hurdle model is found, and is used to adjust for coexpression between genes.
We drop genes if the coefficient we are testing was not estimible in original model fit in zFit or in any of the bootstrap replicates (evidenced an NA in the bootstrap array).  This might yield overly conservative inference.
Since bootstrapping is a randomized procedure, the degrees of freedom of a module (and its variance parameters) might differ from run-to-run.
You might try setting var_estimate='modelbased' to relax this requirement by assuming independence between genes and then using the asymptotic covariance estimates, which are deterministic, but may result in overly-generous inference."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MAST</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.21.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MAITAnalysis.html">Using MAST with RNASeq: MAIT Analysis.</a>
    </li>
    <li>
      <a href="../articles/MAST-Intro.html">MAST Intro</a>
    </li>
    <li>
      <a href="../articles/MAST-interoperability.html">Interoptability between MAST and SingleCellExperiment-derived packages.</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/RGLab/MAST/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gene set analysis for hurdle model</h1>
    <small class="dont-index">Source: <a href="https://github.com/RGLab/MAST/blob/HEAD/R/GSEA-by-boot.R" class="external-link"><code>R/GSEA-by-boot.R</code></a></small>
    <div class="hidden name"><code>gseaAfterBoot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Modules defined in <code>sets</code> are tested for average differences in expression from the "average" gene.
By using bootstraps, the between-gene covariance of terms in the hurdle model is found, and is used to adjust for coexpression between genes.
We drop genes if the coefficient we are testing was not estimible in original model fit in <code>zFit</code> or in any of the bootstrap replicates (evidenced an <code>NA</code> in the bootstrap array).  This might yield overly conservative inference.
Since bootstrapping is a randomized procedure, the degrees of freedom of a module (and its variance parameters) might differ from run-to-run.
You might try setting <code>var_estimate='modelbased'</code> to relax this requirement by assuming independence between genes and then using the asymptotic covariance estimates, which are deterministic, but may result in overly-generous inference.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gseaAfterBoot</span><span class="op">(</span>
  <span class="va">zFit</span>,
  <span class="va">boots</span>,
  <span class="va">sets</span>,
  <span class="va">hypothesis</span>,
  control <span class="op">=</span> <span class="fu">gsea_control</span><span class="op">(</span>n_randomize <span class="op">=</span> <span class="cn">Inf</span>, var_estimate <span class="op">=</span> <span class="st">"bootall"</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">gsea_control</span><span class="op">(</span>n_randomize <span class="op">=</span> <span class="cn">Inf</span>, var_estimate <span class="op">=</span> <span class="st">"bootall"</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>zFit</dt>
<dd><p>object of class ZlmFit</p></dd>
<dt>boots</dt>
<dd><p>bootstraps of zFit</p></dd>
<dt>sets</dt>
<dd><p>list of indices of genes</p></dd>
<dt>hypothesis</dt>
<dd><p>a <code>Hypothesis</code> to test. Currently only one degree <code>CoefficientHypothesis</code> are supported.</p></dd>
<dt>control</dt>
<dd><p>parameters as provided by <code>gsea_control</code>.  See details.</p></dd>
<dt>n_randomize</dt>
<dd><p>the number of genes to sample to approximate the non-module average expression. Set to <code>Inf</code> to turn off the approximation (the default).</p></dd>
<dt>var_estimate</dt>
<dd><p>the method used to estimate the variance of the modules, one of <code>bootall</code>, <code>bootdiag</code>, or <code>modelbased</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Object of class <code>GSEATests</code>, containing slots <code>tests</code>,  4D array and <code>bootR</code>, the number of boostrap replicates.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>gsea_control</code>: set control parameters.  See Details.</p></li>
</ul></div>
    <div id="control">
    <h2><code>control</code></h2>
    

<p><code>control</code> is a list with elements:</p><ul><li><p><code>n_randomize</code>, giving the number of genes to sample to approximate the non-module average expression. Set to <code>Inf</code> to turn off the approximation (the default).</p></li>
<li><p><code>var_estimate</code>, giving the method used to estimate the variance of the modules.  <code>bootall</code> uses the bootstrapped covariance matrices.  <code>bootdiag</code> uses only the diagonal of the bootstrapped covariance matrix (so assuming independence across genes). <code>modelbased</code> assumes independence across genes and uses the variance estimated from the model.</p></li>
</ul></div>
    <div id="return-value">
    <h2>Return Value</h2>
    

<p>A 4D array is returned, with  dimensions "set" (each module), "comp" ('disc'rete or 'cont'inuous), "metric" ('stat' gives the average of the coefficient, 'var' gives the variance of that average, 'dof' gives the number of genes that were actually tested in the set), "group" ('test' for the genes in test-set, "null" for all genes outside the test-set).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="calcZ.html">calcZ</a></p>
<p>summary,GSEATests-method</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">vbetaFA</span><span class="op">)</span></span>
<span class="r-in"><span class="va">vb1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">vbetaFA</span>, <span class="va">ncells</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">vb1</span> <span class="op">=</span> <span class="va">vb1</span><span class="op">[</span>,<span class="fu"><a href="freq.html">freq</a></span><span class="op">(</span><span class="va">vb1</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">.1</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span></span>
<span class="r-in"><span class="va">zf</span> <span class="op">=</span> <span class="fu"><a href="zlm.html">zlm</a></span><span class="op">(</span><span class="op">~</span><span class="va">Stim.Condition</span>, <span class="va">vb1</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done!</span>
<span class="r-in"><span class="va">boots</span> <span class="op">=</span> <span class="fu"><a href="bootVcov1.html">bootVcov1</a></span><span class="op">(</span><span class="va">zf</span>, <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sets</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, B<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">10</span>, C<span class="op">=</span><span class="fl">15</span>, D<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gsea</span> <span class="op">=</span> <span class="fu">gseaAfterBoot</span><span class="op">(</span><span class="va">zf</span>, <span class="va">boots</span>, <span class="va">sets</span>, <span class="fu"><a href="Hypothesis.html">CoefficientHypothesis</a></span><span class="op">(</span><span class="st">'Stim.ConditionUnstim'</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Use a model-based estimate of the variance/covariance.</span></span>
<span class="r-in"><span class="va">gsea_mb</span> <span class="op">=</span> <span class="fu">gseaAfterBoot</span><span class="op">(</span><span class="va">zf</span>, <span class="va">boots</span>, <span class="va">sets</span>, <span class="fu"><a href="Hypothesis.html">CoefficientHypothesis</a></span><span class="op">(</span><span class="st">'Stim.ConditionUnstim'</span><span class="op">)</span>,</span>
<span class="r-in">control <span class="op">=</span> <span class="fu">gsea_control</span><span class="op">(</span>var_estimate <span class="op">=</span> <span class="st">'modelbased'</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="calcZ.html">calcZ</a></span><span class="op">(</span><span class="va">gsea</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , metric = Z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    comp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set      cont      disc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A -1.301014 -0.583344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B -2.237545 -3.852267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C       NaN -7.174852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D -1.301014 -0.583344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> , , metric = P</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    comp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> set       cont         disc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   A 0.22959122 0.5803073617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   B 0.08608739 0.0128445625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   C        NaN 0.0006287414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   D 0.22959122 0.5803073617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gsea</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    set    cont_Z     cont_P    disc_Z       disc_P combined_Z  combined_P</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:   C       NaN        NaN -7.174852 0.0006287414 -4.0832752 0.008350288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:   B -2.237545 0.08608739 -3.852267 0.0128445625 -1.7951462 0.138073721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:   A -1.301014 0.22959122 -0.583344 0.5803073617 -0.8522742 0.414748270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:   D -1.301014 0.22959122 -0.583344 0.5803073617 -0.8522742 0.414748270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    cont_effect disc_effect combined_adj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:         NaN   -1.503876   0.03340115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:  -0.8174711   -1.235057   0.27614744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  -0.3400834   -0.184799   0.41474827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  -0.3400834   -0.184799   0.41474827</span>
<span class="r-in"><span class="co"># \dontshow{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">gsea</span><span class="op">@</span><span class="va">tests</span><span class="op">[</span><span class="st">'A'</span>,,,<span class="op">]</span>,<span class="va">gsea</span><span class="op">@</span><span class="va">tests</span><span class="op">[</span><span class="st">'D'</span>,,,<span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">gsea</span><span class="op">@</span><span class="va">tests</span><span class="op">[</span><span class="st">'C'</span>,<span class="st">'cont'</span>,<span class="st">'stat'</span>,<span class="st">'test'</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">zf</span>, <span class="st">'C'</span><span class="op">)</span><span class="op">[</span><span class="fl">15</span>,<span class="st">'Stim.ConditionUnstim'</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andrew McDavid, Greg Finak, Masanao Yajima.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

